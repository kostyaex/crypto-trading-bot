Приложение в разработке

# Crypto Trading Bot

Это приложение для автоматической торговли на криптовалютных биржах. Оно включает следующие функции:

- Сбор данных с бирж.
- Анализ рыночных данных.
- Управление торговыми стратегиями через поведенческие деревья.
- Бэктестинг торговых стратегий.
- REST API и веб-интерфейс для управления системой

# Функциональные требования

1. Сбор данных с бирж  

    Приложение должно подключаться к нескольким биржам (например, Binance, Huobi) через API.
    Поддержка сбора рыночных данных (цены, объемы, сделки) для различных торговых инструментов (например, BTCUSD).
    Данные должны сохраняться в базу данных PostgreSQL для последующего анализа.
     

2. Анализ данных  

    Реализация модуля анализа данных, который вычисляет технические показатели (например, RSI, MACD, Moving Averages).
    Результаты анализа (сигналы, индикаторы) должны сохраняться в базу данных PostgreSQL.
    Возможность настройки аналитических моделей через конфигурацию или интерфейс.
     

3. Поведенческие деревья (Behavior Trees)  

    Реализация системы поведенческих деревьев для управления торговыми стратегиями.
    Поддержка динамического создания, изменения и удаления сценариев поведенческих деревьев без перезапуска приложения.
    Хранение состояния поведенческих деревьев в базе данных PostgreSQL.
    Возможность отслеживать текущее состояние выполнения каждого дерева.
     

4. Управление сценариями  

    Реализация API для управления сценариями поведенческих деревьев:
        Создание нового сценария.
        Обновление существующего сценария.
        Удаление сценария.
        Получение текущего состояния сценария.
         
    Поддержка командной строки для управления сценариями через API.
    Веб-интерфейс для удобного управления сценариями и мониторинга их выполнения.
     

5. Торговые операции  

    Реализация модуля для выполнения торговых операций (покупка/продажа) на основе сигналов, полученных из поведенческих деревьев.
    Поддержка различных типов ордеров (рыночные, лимитные).
    Логирование всех торговых операций для последующего анализа.
     

6. Хранение данных  

    Использование PostgreSQL для хранения:
        Данных биржи (рыночные данные).
        Результатов анализа (технические индикаторы, сигналы).
        Состояния поведенческих деревьев.
        Определений сценариев поведенческих деревьев.
         
    Оптимизация запросов к базе данных для быстрого доступа к данным.
     

7. Мониторинг и управление  

    Реализация веб-интерфейса для:
        Просмотра текущих данных биржи.
        Мониторинга результатов анализа.
        Управления сценариями поведенческих деревьев.
        Отслеживания состояния выполнения торговых операций.
         
    Логирование всех событий системы для отладки и анализа.    

8. Масштабируемость и надежность  

    Поддержка горизонтального масштабирования для обработки большого объема данных.
    Реализация механизмов повторных попыток и обработки ошибок для работы с внешними API бирж.
    Надежное хранение данных в PostgreSQL с использованием транзакций и индексов.
     

9. Безопасность  

    Защита API и веб-интерфейса с использованием аутентификации и авторизации.
    Шифрование чувствительных данных (например, API-ключи бирж) в конфигурации и базе данных.
     

10. Расширяемость  

    Архитектура приложения должна быть модульной, чтобы легко добавлять новые биржи, аналитические модели и торговые стратегии.
    Поддержка плагинов или расширений для добавления новых функций.
     

11. Интеграция с внешними сервисами  

    Возможность отправки уведомлений (например, через Telegram, Email) о важных событиях (например, успешные/неудачные торговые операции).
    Интеграция с внешними сервисами для дополнительного анализа данных (например, машинное обучение, прогнозирование).
     

12. Тестирование и документация  

    Наличие модульных тестов для проверки корректности работы всех компонентов.
    Документация для разработчиков и пользователей, описывающая:
        Установку и настройку приложения.
        Использование API и веб-интерфейса.
        Создание и управление сценариями поведенческих деревьев.

13. Бэктестинг торговых стратегий
13.1. Исторические данные  

    Приложение должно поддерживать загрузку и хранение исторических данных биржи (например, цены, объемы, сделки) за определенный период времени.
    Исторические данные могут быть получены:
        Напрямую из API бирж (если поддерживаются исторические данные).
        Из сторонних источников (например, CSV-файлы или другие базы данных).
         
    Данные должны сохраняться в PostgreSQL для последующего использования.
     

13.2. Симуляция торговли  

    Реализация модуля для симуляции торговли на основе исторических данных:
        Воспроизведение рыночных данных пошагово (например, по временному интервалу: минута, час, день).
        Применение торговых стратегий (поведенческие деревья) к каждому шагу данных.
        Вычисление результатов торговли (например, прибыль/убыток, количество успешных/неудачных сделок).
         
     

14.3. Настройка параметров бэктестинга  

    Возможность настройки параметров бэктестинга через конфигурацию или интерфейс:
        Период тестирования (например, дата начала и окончания).
        Таймфрейм данных (например, 1 минута, 5 минут, 1 час).
        Начальный капитал для симуляции.
        Комиссии и спреды, учитываемые при расчетах.
         
     

14.4. Отчеты и аналитика  

    Генерация отчетов по результатам бэктестинга:
        Общая прибыль/убыток.
        Максимальная просадка (drawdown).
        Процент успешных сделок.
        Соотношение прибыльных и убыточных сделок.
        Графики изменения капитала и других показателей.
         
    Возможность экспорта отчетов в форматы (например, PDF, CSV).
     

14.5. Интерфейс для бэктестинга  

    Реализация веб-интерфейса для удобного запуска и мониторинга бэктестинга:
        Выбор торговой стратегии (поведенческого дерева).
        Настройка параметров бэктестинга.
        Отображение результатов в реальном времени (например, график изменения капитала).
        Просмотр деталей каждой сделки (цена входа/выхода, прибыль/убыток).
         
     

14.6. Автоматизация бэктестинга  

    Поддержка автоматического запуска бэктестинга для нескольких стратегий и периодов.
    Возможность сравнения результатов различных стратегий.
     

14.7. Расширяемость  

    Архитектура должна позволять легко добавлять новые метрики и методы анализа результатов бэктестинга.
    Поддержка интеграции с внешними инструментами для анализа данных (например, машинное обучение, статистический анализ).
     

# Структура проекта

```
internal/
 ├─ core/            ← минимальные зависимости, почти ничего не зависит от других
 ├─ service/          ← зависит от core
 ├─ domain/           ← минимальная логика, используется всеми
 └─ app/              ← зависит от core, service, domain
 └─ web/              ← зависит от core, service, domain, app
```

```
trading-bot/
├── cmd/
│   ├── bot/
│   │   └── main.go
│   └── web/
│       └── main.go
├── internal/
│   ├── core/                  ← Общий базовый функционал (используется всеми)
│   │   ├── config/            └── загрузка конфигов
│   │   ├── logger/            └── логирование
│   │   └── storage/           └── работа с БД
│   │
│   ├── service/               ← Служебные модули (зависят от core)
│   │   ├── exchange/          └── клиенты бирж
│   │   ├── analysis/          └── анализ данных
│   │   └── utils/             └── общие утилиты
│   │
│   ├── domain/                ← Бизнес-область: модели, интерфейсы стратегий
│   │   ├── model.go           └── общие структуры: свечи, сигналы, позиции
│   │   └── strategy.go        └── интерфейс Strategy
│   │
│   ├── app/                   ← Высокоуровневые компоненты (зависят от всего)
│   │   ├── strategy/          └── реализации стратегий
│   │   ├── trader/            └── исполнение сделок
│   │   ├── backtest/          └── бектестинг
│   │   └── scheduler/         └── планировщик задач
│   │
│   └── web/                   ← Веб-интерфейс
│       ├── api/
│       └── handler/
└── go.mod

```

# Разработка

Сформировать код модели, репозитория, сервиса для новой сущности:
`go run cmd/generate/main.go -package crypto-trading-bot -model MarketDataStatus -fields "Exchange:string:exchange:text,Symbol:string:symbol:text,TimeFrame:string:time_frame:text,Active:bool:active:BOOLEAN,ActualTime:time.Time:actual_time:timestamp,Status:string:status:text"`